pipeline {
    agent any

    stages {
        stage('git checkout') {
            steps {
                git 'https://github.com/Msocial123/Retail-App_kubernetes.git'
            }
        }
        
        stage('docker build & push'){
            steps {
                script {
                    withDockerRegistry(credentialsId: 'docker-cred') {
                     sh 'docker build -t retail-app:v1 .'
                     sh 'docker tag retail-app:v1 muralisocial123/retail-app:v1'
                     sh 'docker push muralisocial123/retail-app:v1'
                    }
                }
            }
        }
    }
}


====================================

# if you get docker login failure error nad daemon permission denied error execute the follwoing commands
sudo usermod -aG docker ubuntu
newgrp docker sudo chmod 777 /var/run/docker.sock
sudo usermod -aG docker jenkins
sudo systemctl restart jenkins
